<h1>Ana-Çift İç Nokta Metotları (Primal-Dual Interior-Point Methods)</h1>
<!DOCTYPE html>
<html>
  <head>
    <title>Ana-Çift İç Nokta Metotları (Primal-Dual Interior-Point Methods)
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [["$","$"]]}
      });
    MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
      MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
        cancel: ["Extension","cancel"],
        bcancel: ["Extension","cancel"],
        xcancel: ["Extension","cancel"],
        cancelto: ["Extension","cancel"]
      });
    });
    </script>
<script type="text/javascript"
   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full">
</script>
</head>

<p>Şimdiye kadar gördüğümüz problem tiplerini hatırlayalım şimdi ve çözme
zorluğu açısından sıralayalım. En üstte, en basit olan karesel
problemlerdi, </p>
<p>$$
\min_x \frac{1}{2}  x^T Q x + c^T x
$$</p>
<p>formunda oluyorlardı. Bu problemler en basiti, eğer $Q$ pozitif yarı-kesin
ise. Basit çünkü gradyani alıp sıfıra eşitliyorum, pat diye sonucu
buluyorum. </p>
<p>Sonraki seviye, biraz daha zor, üstteki probleme $Ax=b$ formunda eşitlik
kısıtlaması getirmek. Bu problemi de kapalı / analitik halde (closed-form)
çözebiliriz, KKT koşullarını kullanarak. $Ax=b$ ifadesini ek değişkenler
üzerinden kritere ekleriz, Lagrangian'i oluştururuz, KKT koşulunda iki tane
öğe olur, durağanlık, ve ana olurluk, bu iki öğeyi eşzamanlı olarak çözerek
sonuca ulaşırız, koca bir lineer sistemdir bu. </p>
<p>Bir sonraki pürüzsüz minimizasyon, yani üstteki kriterin yerine $f(x)$
kullanmak ki $f(x)$ bir pürüzsüz fonksiyon. Bu durumda Newton metotu
kullanıyoruz, bu metot $Ax=b$ kısıtlamasında $f(x)$ minimizasyonunu birkaç
adımda çözmeye uğraşıyor, bunu her adımda $f(x)$'e bir karesel yaklaşıklama
yaparak başarıyor. </p>
<p>Sonraki seviye ise iç nokta metotları, eşitlik kısıtlamalarına ek olarak
$h_i(x) \le 0, i=1,..,m$ formunda eşitsizlik kısıtlamaları eklemek.  Bu
derste bu tür problemleri ana-çift yöntemi ile çözeceğiz, daha önceki bir
derste bariyer yöntemi iç nokta metotu ile çözdük. </p>
<p>Genel olarak yaptığımız herhangi bir seviyedeki problemi çözmeye
uğraştığımızda onu bir önce seviyedeki probleme indirgemek, problemi belli
adımlara bölerek her adımda nasıl işlediğini bildiğimiz önceki seviyedeki
tekniği uygulamak. Bariyer metotunda öyle oldu mesela, eşitsizlik
problemini bariyer terimini kritere ekleyerek bilinen Newton adımlarıyla
onu çözmeye uğraştık. </p>
<p>Ana-çift metotu biraz daha farklı olacak. Onu öğrendiğimizde göreceksiniz
ki bir problemi açık bir şekilde başka bir probleme indirgemediğini
göreceksiniz [1, 5:55]. Bu tekniği sarsıma puğratılmış KKT koşulları
ışığında ele almak lazım, ana prensibi bu. </p>
<p>[bariyer metot ozeti atlandi]</p>
<p>Ana-çift metotu, bariyer metodundan farklı olarak, $t$ parametresinin
güncellemeden önce sadece tek Newton adımı atar. Yani ana-çift metotunda da
yaklaşıksallamanın kuvvetini kontrol eden bir $t$ var, ama o belli bir $t$
üzerinden yakınsama oluncaya kadar Newton adımı atmak yerine her $t$ için
tek Newton adımı atılıyor. Bu demektir ki dış döngü, iç döngü farkı yok,
her şey tek bir döngü içinde.</p>
<p>Bir diğer fark ana-çift döngüsünde giderken üretilen (ziyaret edilen)
noktalar illa olurlu olmayabiliyor. Yapısı itibariyle metot döngüsü
sırasında eşitsizlik kısıtlamalarını tatmin eder, fakat her zaman eşitlik
kısıtlamalarını tatmin etmeyebilir. Hatta bazen ikiz olurlu noktalar bile
mevcut olmayabilir, bu daha ciddi bir durum. Hatırlarsak bariyer metotunda
ikiz olurlu nokta her zaman vardı ve bu noktayı bir ikiz boşluğu hesaplamak
için kullanabiliyorduk. Bu boşluğu hesaplamak kolaydı, her noktada
$m / t &lt; \epsilon$ değerindeydi.</p>
<p>O zaman ana-çift ile bu hesap yoksa, ne zaman duracağımızı tam bilmiyoruz
demektir, demek ki akıllıca uydurma (heuristic) yaparak bir durma şartı
bulmamız lazım.</p>
<p>Pozitif bağlamda ana-çift metotları daha verimli çalışır. İspatına
girmeyeceğiz ama ana-çift yakınsaması lineerden daha iyidir.</p>
<p>Negatif olarak ana-çift metotlarını kabaca, sezgisel kavramak bariyer
metotu kadar direk olmayabilir. Şahsen bu alanda araştırmacı olan ben bile
ana-çift metot adımlarının temelii hatırlamakta bazen zorlanıyorum, bariyer
metotunu hatırlamak basit, kısıtlamanın log'unu alıp kritere ekliyorsunuz,
sonra Newton metotu uyguluyorsunuz [13:35].</p>
<p>Detaylara gelelim. KKT koşul sarsımını hatırlarsak, bariyer metotunu KKT
koşullarinda bir sarsım olarak görebiliyorduk, şu ifadelerde</p>
<p>$$
\nabla f(x) + \sum_{i=1}^{m} u_i\nabla h_i + A^T v = 0
\qquad (1)
$$</p>
<p>$$
u_i \cdot h_i(x) = (-1/t) 1, \quad i=1,..,m
$$</p>
<p>$$
h_i(x) \le 0, \quad i=1,..,m, \quad Ax = b
$$</p>
<p>$$
u_i \ge 0
$$</p>
<p>Bloktaki ikinci ifade yerine </p>
<p>$$
u_i \cdot h_i(x) = 0, \quad i=1,..,m
\qquad (2)
$$</p>
<p>kullanıyoruz. Değisen tamamlayıcı gevşeklik yani.</p>
<p>Ana problem neydi?</p>
<p>$$
\min_x f(x) \quad \textrm{öyle ki}
$$
$$
Ax = b
$$
$$
h_i(x) \le 0, \quad i=1,..,m
$$</p>
<p>Bu problemin KKT şartları görülen blokta, durağanlık için gradyan alıp
sıfıra eşitlenir, (1)'i elde edilir, tabii $f,h_i$'in pürüzsüz ve dışbükey
olduğu farz edilir, o sebeple gradyan yeterli, altgradyana gerek yok, vs.
Tek değiştirdiğimiz tamamlayıcı gevşeklik ve onun artık sıfıra eşit
olmasını şart koşmuyorum, ufak başka bir değere, ve doğru işarete sahip
olan başka bir değere eşit olmasını zorluyorum, $u_i \cdot h_i(x) = (-1/t)$
şartı bu. $1/t$ gibi bir değerin sebebi aslında $\log(x)$'in türevinin
$1/\log(x)$ olmasıyla alakalı, çünkü log bariyerleştirilmiş kriterin
türevini alıp sıfıra eşitleyince ve ikiz değişkenleri uygun şekilde
tanımlayınca log bariyer metotunun orijinal KKT koşulları yerine üstteki
şekilde bir problemi çözülebildiğini görmüştük [1, 16:19], ve $t$
büyütüldükçe görülen değiştirilmiş tamamlayıcı gevşeklik esas versiyonuna
daha da yaklaşıyordu.</p>
<p>[bariyer KKT matris versiyonu atlandı]</p>
<p>a-c metotlarına erişmenin bir diğer yolu sarşımın ortaya çıkarttığı
denklemleri birarada çözmek ve Newton adımını ona göre atmak [1, 22:55]. 
Sarşım denklem sistemini sıfıra eşitlemek amacıyla matris formunda
düzenlersek, </p>
<p>$$
r(x,u,v) = 
\left[\begin{array}{c}
\nabla f(x) + Dh(x)^T u + A^T v \\
-\mathrm{diag}(u)h(x) - 1/t \\
Ax - b
\end{array}\right]
$$</p>
<p>ki</p>
<p>$$
h(x) = \left[\begin{array}{c}
h_1(x) \\
\dots
h_m(x)
\end{array}\right]
\quad
D h(x) = \left[\begin{array}{c}
D h_1(x)^T \\
\dots \\
D h_m(x)^T
\end{array}\right]
$$</p>
<p>[devam edecek]</p>
<p>Kaynaklar</p>
<p>[1] Tibshirani, <em>Convex Optimization, Lecture Video 16</em>, 
<a href="https://www.youtube.com/channel/UCIvaLZcfz3ikJ1cD-zMpIXg">https://www.youtube.com/channel/UCIvaLZcfz3ikJ1cD-zMpIXg</a>   </p>