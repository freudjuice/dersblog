<h1>Genel Çifteşlik / İkizlik (General Duality)</h1>
<!DOCTYPE html>
<html>
  <head>
    <title>Genel Çifteşlik / İkizlik (General Duality)
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [["$","$"]]}
      });
    MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
      MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
        cancel: ["Extension","cancel"],
        bcancel: ["Extension","cancel"],
        xcancel: ["Extension","cancel"],
        cancelto: ["Extension","cancel"]
      });
    });
    </script>
<script type="text/javascript"
   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full">
</script>
</head>

<p>Ders notları [1]'den alınmıştır. </p>
<p>Bu derste genel dışbükey problemlerinde ikizlik konusunu göreceğiz, ek
olarak dışbükey olmayan durumlara da bakacağız. İkizlik oldukca genel bir
konu. </p>
<p>Önceki derste ikizliği elde etmenin ikinci yönteminde </p>
<p>$$
L(x,u,v) \equiv c^T x + u^T (Ax-b) + v^T (Gx-h) 
$$</p>
<p>tanımı üzerinden (Lagrangian)</p>
<p>$$
f^* = \min_{x \in C} L(x,u,v) \ge \min_x L(x,u,v) \equiv g(u,v)
$$</p>
<p>şeklinde bir formül elde etmiştik, $u,v$ sabitlendiği durumda ve $x \in C$
olurlu çözümleri kümesi olacak şekilde, ve bu küme üzerinden Lagrangian'in,
tüm $x$'ler üzerinden olan Lagrangian'dan her zaman daha büyük olacağını
görmüştük. Aslında bu çok basit bir fikir ama bu basit ve kuvvetli fikir
sayesinde ikizliği genel problemlere uygulamak mümkün oluyor. </p>
<p>Ayrıca, sonradan göreceğimiz üzere, en sağdaki eşitsizlik ikiz çözüm $u,v$
noktasına sıkı (tight), yani olurlu kümeyi bir yana atarak bir şey
kaybetmiş olmadık. Yani üstte görülen eşitsizlik bazılarına gevşek
gelebilir, ama doğru $u,v$'de son derece şıkıdır. </p>
<p>Neyse devam edersek, yine üstte görülen $g(u,v)$ $u,v$'nin bir fonksiyonu
ve işin güzel tarafı çoğunlukla hesaplanabilir bir fonksiyon. Yanı
$L(x,u,v)$'yi $x$ üzeriden minimize etmek $u,v$'nin bir fonksiyonu. </p>
<p>Bir diğer deyişle, $g(u,v)$ fonksiyonu $f^*$ üzerinde herhangi bir $u$ ve
$v \ge 0$ için bir alt sınır. Ikiz fonksiyonu olarak isimlendirilen $g$.</p>
<p>Lagrangian'ı tekrar düzenleyerek alttakini elde etmiştik, </p>
<p>$$
g(u,v) = \left\{ \begin{array}{ll}
-\infty &amp; \text{eğer} \quad c^T + A^Tu + G^T v \ne 0 \\
- b^T u - h^Tu &amp; \text{eğer} \quad c^T + A^Tu + G^T v = 0 
\end{array} \right.
$$</p>
<p>Şimdi LP'lerden ilerleyip, düşünebildiğimiz en genel optimizasyon formuna
bakacağız. Dişbukey (convex) olması şart değil ama tabii ki dışbükey
durumlara özel ilgi göstereceğiz. Form,</p>
<p>$$
\min_{x} f(x), \quad \textrm{öyle ki}
$$
$$
h_i(x) \le 0, \quad i=1,..,m
$$
$$
l_j(x) \le 0, \quad j=1,..,r
$$</p>
<p>Eğer sadece dışbükeylige bakıyor olsaydık $f,h_i$'lerin dışbükey,
$l_i$'lerin ise doğrusal olması gerekirdi. Lagrangian'i tanımlayalım, hala
çok genel bir şekilde yaklaşıyoruz tabii, </p>
<p>$$
L(x,u,v) = f(x) + \sum_{i=1}^{m} u_i h_i(x) + \sum_{i=1}^{r} v_i l_i(x) 
$$</p>
<p>Eşitlik ve eşitsizlik kritlerini ikiz değişkenler ile çarpıp topluyoruz, ve
hedefe ekliyoruz. Daha önce olduğu gibi eşitlik kısıtlamarını çarpan
$u_i$'lar sıfır olmamalı çünkü $f(x)$ ile Lagrangian arasında bir ilişki
kuracağız, ve ana problemdeki eşitsizlin işaret değiştirmesini
istemiyoruz. </p>
<p>Bu arada "ikiz değişkenler" kelimesi duruma göre bazen "Lagrange
çarpanı" olarak görülebilir. </p>
<p>Önemli özellik, her $v$ ve $u \ge 0$ için, her olurlu $x$ noktasında</p>
<p>$$
f(x) \ge L(x,u,v)
$$</p>
<p>Niye? Daha önce LP'lerle gördüğümüz fikirle aynı durum, olurlu noktalarda</p>
<p>$$
L(x,u,v) =  f(x) + 
\sum_{i=1}^{m} u_i \underbrace{h_i(x)}_{\le 0} + 
\sum_{i=1}^{r} v_i \underbrace{l_i(x)}_{=0}
$$</p>
<p>Olurlu noktalarda $l_i$'ler sıfır, o zaman tüm $l_i$'leri toplamı yokolur,
$u_i$'lerin hepsi sıfırdan büyük olmalı ve olurlu noktada $h_i$'ler
sıfırdan küçük, pozitif çarpı negatif eşittir negatif, toplam negatif,
$f(x)$'den bir değer eksiltilmiş olacaktır, bu da muhakkak $f(x)$'den küçük
bir sonuca sebep olacaktır, iki üstteki bu şekilde ispatlanmış olur.</p>
<p>Üstteki fonksiyonu, parçalarını grafiksel olarak alttaki gibi görebiliriz,</p>
<p><img alt="" src="func_56_gendual_01.png" /></p>
<p>Kesiksiz çizgi kriter / hedef fonksiyonu örnek bir $f$. Dikkat edersek
görülen $f$ dışbükey değil, bunu genel dışbükey olmayan ortamlarda da
tekniğin işlediğini göstermek için yaptık. </p>
<p>Noktalı eğrilerin her biri farklı $u$'lar için $L$'nin değerleri, ayrıca
olurlu kümeyi $[-0.46,0.46]$ arasında olacak şekilde seçtik. Yani </p>
<p>$$
\min_{x} f(x), \quad \textrm{öyle ki}
$$
$$
h_i(x) \le 0
$$</p>
<p>programını ele almış olduk, noktalalı eğriler ile çizilen ise </p>
<p>$$
L(x,u) = f(x) + u l(x)
$$</p>
<p>Devam edersek belli bir $f^*$ minimumu düşünelim, </p>
<p>$$
f^* \ge \min_{x \in C} L(x,u,v) \ge \min_x L(x,u,v) \equiv g(u,v)
$$ </p>
<p>LP örneğindeki yaklaşım, sadece olurlu küme $C$ yerine tüm $x$'ler
üzerinden minimizasiyon bir alt sınır oluşturur. $g(u,v)$'ye ikiz fonksiyon
diyoruz.</p>
<p>Peki niye $g(u,v)$ tanımını $\min_{x \in C} L(x,u,v)$ için yapmadım, tüm
$x$'ler üzerinden olan kısıtlanmamış versiyon için yaptım? Çünkü tüm
$x$'ler üzerinden olan tanım bizim için daha faydalı. O tür ifadeler
üzerinde analitik çözüm geliştirmek daha rahattır, analitik çözüm olmasa
bile tüm $x$'ler üzerinden yaklaşım daha faydalı. Tabii hala bazı
kısıtlamalar var, mesela $u \ge 0$ olmalı.</p>
<p>İkiz fonksiyon $g$'nin $\lambda$'ya (aslında $u$) gore bir grafiğini altta görüyoruz,</p>
<p><img alt="" src="func_56_gendual_02.png" /></p>
<p>Kesikli çizgi kriter, ve $g$ her $\lambda$ için kriterin hep altında.</p>
<p>Peki niye ikizi yapabildiğim en büyük değer kriterin olurlu kümede
olabilecek en ufak değerine eşit değil (ikizin tepesi kesikli çizgiye
değmiyor)? Çünkü elimizdeki bir dişbukey olmayan fonksiyon. Dişbukeylik
olsaydı alt sınır sıkı olurdu. Dişbukey olmayan fonksiyonlarda da sıkılık
görülebilir ama dışbükeylık durumundaki gibi bu şart değildir.</p>
<p>Biraz daha zor bir örneğe bakalım. </p>
<p>Standart formda bir karesel program (QP). </p>
<p>$$
\min_x \frac{1}{2} x^T Q x + c^T x \quad \textrm{öyle ki}
$$
$$
Ax = b, \quad x \ge 0
$$</p>
<p>ki $Q$ pozitif kesin, $Q \succ 0$ olarak gösterilir, en küçük özdeğeri
harfiyen sıfırdan büyük (yani $&gt;0$, $\ge 0$ değil), bu durumda üstteki
problem harfiyen dışbükey olur.</p>
<p>Lagrangian için öğrendiğimiz tarifi uygularsak, </p>
<p>$$
L(x,u,v) = \frac{1}{2} x^T Q x + c^Tx  - u^T x + v^T (Ax - b)
\qquad (2)
$$</p>
<p>Ikiz fonksiyonu bulalim simdi. $x$ uzerinden minimizasyon yapilan degisken
olacagi icin $g$'de olmayacak, yani</p>
<p>$$
g(u,v) = \min_x L(x,u,v) 
$$</p>
<p>$x$'ler üzerinden ufak bir gruplama sonrası</p>
<p>$$
= \min_x \frac{1}{2} x^T Q x + (c - u + A^T v)^T x - b^T v<br />
\qquad (1)
$$</p>
<p>Bu minimumu nasıl buluruz? Gradyanı alıp sıfıra eşitleriz değil mi? Tabii
üstteki tanıdık bir formda, eğer tek boyuttan hatırlarsak, </p>
<p>$$
ax^2 + bx + c
$$</p>
<p>formülü olsaydı, çözüm $x^* = \frac{-b}{2a}$ olurdu. Çok boyutlu vektörel
formda</p>
<p>$$
\frac{1}{2} x^T Q x + b^T x
$$</p>
<p>icin cozum $x^* = -Q^{-1} b$. Bunu biliyorum cunku pek cok kez bu cozumu
turettim, hatirliyorum. Bu formu bizim probleme uygularsak, (1) icindeki
parantezde gorulen $c - u + A^T v$ kismi ustteki $b$ oluyor. O zaman
Lagrangian'in minimize edicisi</p>
<p>$$
x^* = -Q^{-1} (c - u + A^T v)
$$</p>
<p>O zaman Lagrangian'in minimum noktasi ustteki minimize ediciyi formule geri
sokunca elde edecegim sey</p>
<p>$$
\min_x L(x,u,v) = L(x^*,u,v)
$$</p>
<p>$$
= \frac{1}{2} 
(c - u + A^Tv)^T Q^{-1} (c - u + A^Tv) - 
(c - u + A^Tv)^T Q^{-1} (c - u + A^Tv) - b^T v
$$</p>
<p>Geriye tek $Q^{-1} $ kaldı çünkü (2)'ye $x^*$'i soktuğumuz zaman $Q$ ile
çarpılan ilk $Q^{-1} $ iptal oldu, ikincisi geriye kaldı, basitleştirince
Lagrange ikiz fonksiyonu elde ediyoruz,</p>
<p>$$
g(u,v) = -\frac{1}{2} (c - u + A^Tv)^T Q^{-1}  (c - u + A^Tv) - b^Tv
\qquad (3)
$$</p>
<p>Yani eğer bana verilen her $u \ge 0$ olan $u$, ve herhangi $v$ için
hesaplayacağım üstteki formül, bana karesel programın optimumu için bir alt
sınır veriyor.</p>
<p>Ne kadar onemsiz olmayan bir sonuc. Bu noktaya son derece onemsiz (gibi
gozuken), gayet basit ifadeleri bir araya koyarak geldik. Ama karesel
program icin elde ettigimiz sonuca bakin. Basta gordugumuz genel form bir
QP. (3)'un bu QP'nin optimal degeri icin bir alt sinir olusturacagi ilk
bakista bariz gibi durmuyor. Ama bu boyle, ve Lagrangian ikiz fonksiyonun
bir ozelliginin sonucu bizi buraya getiriyor, birkac satirlik ifadeyle
ustteki kuvvetli sonucu dogrulayabiliyoruz.</p>
<p>[devam edecek]</p>
<p>Kaynaklar</p>
<p>[1] Tibshirani, <em>Convex Optimization, Lecture Video 11</em>, 
<a href="https://www.youtube.com/channel/UCIvaLZcfz3ikJ1cD-zMpIXg">https://www.youtube.com/channel/UCIvaLZcfz3ikJ1cD-zMpIXg</a>   </p>