\documentclass[12pt,fleqn]{article}\usepackage{../../common}
\begin{document}
Genel Çifteþlik / Ýkizlik (General Duality)

Ders notlarý [1]'den alýnmýþtýr. 

Bu derste genel dýþbükey problemlerinde ikizlik konusunu göreceðiz, ek
olarak dýþbükey olmayan durumlara da bakacaðýz. Ýkizlik oldukca genel bir
konu. 

Önceki derste ikizliði elde etmenin ikinci yönteminde 

$$
L(x,u,v) \equiv c^T x + u^T (Ax-b) + v^T (Gx-h) 
$$

tanýmý üzerinden (Lagrangian)

$$
f^* = \min_{x \in C} L(x,u,v) \ge \min_x L(x,u,v) \equiv g(u,v)
$$

þeklinde bir formül elde etmiþtik, $u,v$ sabitlendiði durumda ve $x \in C$
olurlu çözümleri kümesi olacak þekilde, ve bu küme üzerinden Lagrangian'in,
tüm $x$'ler üzerinden olan Lagrangian'dan her zaman daha büyük olacaðýný
görmüþtük. Aslýnda bu çok basit bir fikir ama bu basit ve kuvvetli fikir
sayesinde ikizliði genel problemlere uygulamak mümkün oluyor. 

Ayrýca, sonradan göreceðimiz üzere, en saðdaki eþitsizlik ikiz çözüm $u,v$
noktasýna sýký (tight), yani olurlu kümeyi bir yana atarak bir þey
kaybetmiþ olmadýk. Yani üstte görülen eþitsizlik bazýlarýna gevþek
gelebilir, ama doðru $u,v$'de son derece þýkýdýr. 

Neyse devam edersek, yine üstte görülen $g(u,v)$ $u,v$'nin bir fonksiyonu
ve iþin güzel tarafý çoðunlukla hesaplanabilir bir fonksiyon. Yaný
$L(x,u,v)$'yi $x$ üzeriden minimize etmek $u,v$'nin bir fonksiyonu. 

Bir diðer deyiþle, $g(u,v)$ fonksiyonu $f^*$ üzerinde herhangi bir $u$ ve
$v \ge 0$ için bir alt sýnýr. Ikiz fonksiyonu olarak isimlendirilen $g$.

Lagrangian'ý tekrar düzenleyerek alttakini elde etmiþtik, 

$$
g(u,v) = \left\{ \begin{array}{ll}
-\infty & \text{eðer} \quad c^T + A^Tu + G^T v \ne 0 \\
- b^T u - h^Tu & \text{eðer} \quad c^T + A^Tu + G^T v = 0 
\end{array} \right.
$$

Þimdi LP'lerden ilerleyip, düþünebildiðimiz en genel optimizasyon formuna
bakacaðýz. Diþbukey (convex) olmasý þart deðil ama tabii ki dýþbükey
durumlara özel ilgi göstereceðiz. Form,

$$
\min_{x} f(x), \quad \textrm{öyle ki}
$$
$$
h_i(x) \le 0, \quad i=1,..,m
$$
$$
l_j(x) \le 0, \quad j=1,..,r
$$

Eðer sadece dýþbükeylige bakýyor olsaydýk $f,h_i$'lerin dýþbükey,
$l_i$'lerin ise doðrusal olmasý gerekirdi. Lagrangian'i tanýmlayalým, hala
çok genel bir þekilde yaklaþýyoruz tabii, 

$$
L(x,u,v) = f(x) + \sum_{i=1}^{m} u_i h_i(x) + \sum_{i=1}^{r} v_i l_i(x) 
$$

Eþitlik ve eþitsizlik kritlerini ikiz deðiþkenler ile çarpýp topluyoruz, ve
hedefe ekliyoruz. Daha önce olduðu gibi eþitlik kýsýtlamarýný çarpan
$u_i$'lar sýfýr olmamalý çünkü $f(x)$ ile Lagrangian arasýnda bir iliþki
kuracaðýz, ve ana problemdeki eþitsizlin iþaret deðiþtirmesini
istemiyoruz. 

Bu arada ``ikiz deðiþkenler'' kelimesi duruma göre bazen ``Lagrange
çarpaný'' olarak görülebilir. 

Önemli özellik, her $v$ ve $u \ge 0$ için, her olurlu $x$ noktasýnda

$$
f(x) \ge L(x,u,v)
$$

Niye? Daha önce LP'lerle gördüðümüz fikirle ayný durum, olurlu noktalarda

$$
L(x,u,v) =  f(x) + 
\sum_{i=1}^{m} u_i \underbrace{h_i(x)}_{\le 0} + 
\sum_{i=1}^{r} v_i \underbrace{l_i(x)}_{=0}
$$

Olurlu noktalarda $l_i$'ler sýfýr, o zaman tüm $l_i$'leri toplamý yokolur,
$u_i$'lerin hepsi sýfýrdan büyük olmalý ve olurlu noktada $h_i$'ler
sýfýrdan küçük, pozitif çarpý negatif eþittir negatif, toplam negatif,
$f(x)$'den bir deðer eksiltilmiþ olacaktýr, bu da muhakkak $f(x)$'den küçük
bir sonuca sebep olacaktýr, iki üstteki bu þekilde ispatlanmýþ olur.

Üstteki fonksiyonu, parçalarýný grafiksel olarak alttaki gibi görebiliriz,

\includegraphics[width=20em]{func_56_gendual_01.png}

Kesiksiz çizgi kriter / hedef fonksiyonu örnek bir $f$. Dikkat edersek
görülen $f$ dýþbükey deðil, bunu genel dýþbükey olmayan ortamlarda da
tekniðin iþlediðini göstermek için yaptýk. 

Noktalý eðrilerin her biri farklý $u$'lar için $L$'nin deðerleri, ayrýca
olurlu kümeyi $[-0.46,0.46]$ arasýnda olacak þekilde seçtik. Yani 

$$
\min_{x} f(x), \quad \textrm{öyle ki}
$$
$$
h_i(x) \le 0
$$

programýný ele almýþ olduk, noktalalý eðriler ile çizilen ise 

$$
L(x,u) = f(x) + u l(x)
$$

Devam edersek belli bir $f^*$ minimumu düþünelim, 

$$
f^* \ge \min_{x \in C} L(x,u,v) \ge \min_x L(x,u,v) \equiv g(u,v)
$$ 

LP örneðindeki yaklaþým, sadece olurlu küme $C$ yerine tüm $x$'ler
üzerinden minimizasiyon bir alt sýnýr oluþturur. $g(u,v)$'ye ikiz fonksiyon
diyoruz.

Peki niye $g(u,v)$ tanýmýný $\min_{x \in C} L(x,u,v)$ için yapmadým, tüm
$x$'ler üzerinden olan kýsýtlanmamýþ versiyon için yaptým? Çünkü tüm
$x$'ler üzerinden olan taným bizim için daha faydalý. O tür ifadeler
üzerinde analitik çözüm geliþtirmek daha rahattýr, analitik çözüm olmasa
bile tüm $x$'ler üzerinden yaklaþým daha faydalý. Tabii hala bazý
kýsýtlamalar var, mesela $u \ge 0$ olmalý.

Ýkiz fonksiyon $g$'nin $\lambda$'ya (aslýnda $u$) gore bir grafiðini altta görüyoruz,

\includegraphics[width=20em]{func_56_gendual_02.png}

Kesikli çizgi kriter, ve $g$ her $\lambda$ için kriterin hep altýnda.

Peki niye ikizi yapabildiðim en büyük deðer kriterin olurlu kümede
olabilecek en ufak deðerine eþit deðil (ikizin tepesi kesikli çizgiye
deðmiyor)? Çünkü elimizdeki bir diþbukey olmayan fonksiyon. Diþbukeylik
olsaydý alt sýnýr sýký olurdu. Diþbukey olmayan fonksiyonlarda da sýkýlýk
görülebilir ama dýþbükeylýk durumundaki gibi bu þart deðildir.

Biraz daha zor bir örneðe bakalým. 

Standart formda bir karesel program (QP). 

$$
\min_x \frac{1}{2} x^T Q x + c^T x \quad \textrm{öyle ki}
$$
$$
Ax = b, \quad x \ge 0
$$

ki $Q$ pozitif kesin, $Q \succ 0$ olarak gösterilir, en küçük özdeðeri
harfiyen sýfýrdan büyük (yani $>0$, $\ge 0$ deðil), bu durumda üstteki
problem harfiyen dýþbükey olur.

Lagrangian için öðrendiðimiz tarifi uygularsak, 

$$
L(x,u,v) = \frac{1}{2} x^T Q x + c^Tx  - u^T x + v^T (Ax - b)
\mlabel{2}
$$

Ikiz fonksiyonu bulalim simdi. $x$ uzerinden minimizasyon yapilan degisken
olacagi icin $g$'de olmayacak, yani

$$
g(u,v) = \min_x L(x,u,v) 
$$

$x$'ler üzerinden ufak bir gruplama sonrasý

$$
= \min_x \frac{1}{2} x^T Q x + (c - u + A^T v)^T x - b^T v  
\mlabel{1}
$$

Bu minimumu nasýl buluruz? Gradyaný alýp sýfýra eþitleriz deðil mi? Tabii
üstteki tanýdýk bir formda, eðer tek boyuttan hatýrlarsak, 

$$
ax^2 + bx + c
$$

formülü olsaydý, çözüm $x^* = \frac{-b}{2a}$ olurdu. Çok boyutlu vektörel
formda

$$
\frac{1}{2} x^T Q x + b^T x
$$

icin cozum $x^* = -Q^{-1} b$. Bunu biliyorum cunku pek cok kez bu cozumu
turettim, hatirliyorum. Bu formu bizim probleme uygularsak, (1) icindeki
parantezde gorulen $c - u + A^T v$ kismi ustteki $b$ oluyor. O zaman
Lagrangian'in minimize edicisi

$$
x^* = -Q^{-1} (c - u + A^T v)
$$

O zaman Lagrangian'ýn minimum noktasý üstteki minimize ediciyi formüle geri
sokunca elde edeceðim þey

$$
\min_x L(x,u,v) = L(x^*,u,v)
$$

$$
= \frac{1}{2} 
(c - u + A^Tv)^T Q^{-1} (c - u + A^Tv) - 
(c - u + A^Tv)^T Q^{-1} (c - u + A^Tv) - b^T v
$$

Geriye tek $Q^{-1} $ kaldý çünkü (2)'ye $x^*$'i soktuðumuz zaman $Q$ ile
çarpýlan ilk $Q^{-1} $ iptal oldu, ikincisi geriye kaldý, basitleþtirince
Lagrange ikiz fonksiyonu elde ediyoruz,

$$
g(u,v) = -\frac{1}{2} (c - u + A^Tv)^T Q^{-1}  (c - u + A^Tv) - b^Tv
\mlabel{3}
$$

Yani eðer bana verilen her $u \ge 0$ olan $u$, ve herhangi $v$ için
hesaplayacaðým üstteki formül, bana karesel programýn optimumu için bir alt
sýnýr veriyor.

Ne kadar önemsiz olmayan bir sonuç. Bu noktaya son derece önemsiz (gibi
gözüken), gayet basit ifadeleri bir araya koyarak geldik. Ama karesel
program için elde ettiðimiz sonuca bakýn. Baþta gördüðümüz genel form bir
QP. (3)'un bu QP'nin optimal deðeri için bir alt sýnýr oluþturacaðý ilk
bakýþta bariz gibi durmuyor. Ama bu böyle, ve Lagrangian ikiz fonksiyonun
bir özelliðinin sonucu bizi buraya getiriyor, birkaç satýrlýk ifadeyle
üstteki kuvvetli sonucu doðrulayabiliyoruz.

Farklý bir varyasyona bakalým þimdi, ya $Q \succeq 0$ olsaydý, yani $Q$
pozitif yarý kesin olsaydý?

Bu durumda yine Lagrangian'in gradyanýný alýp sýfýra eþitlerdik, vs. ve 

$$
Qx = -(c-u+A^Tv) 
\mlabel{4}
$$

elde ederdik, fakat $Q$'nun tersini alýp $x$'i elde edemezdik çünkü $Q$
pozitif kesin deðil. 

Çözüm için iki þartý gözönüne almak lazým,

1) $c-u+A^T v \in col(Q)$ ki $col(Q)$ $Q$'nun kolon uzayý demek, yani (4)
lineer ifadesini tatmin eden bir $x$ var. Bu durumda $x^*$

$$
x^* = -Q^{+}(c-u+A^Tv)
$$

olarak yazýlabilir, ki $^+$ iþareti genelleþtirilmiþ ters (generalized inverse)
demek. Bu iþleme bazen sözde ters (pseudo inverse) ismi de veriliyor. Bu
iþlem çoðunlukla eþsiz deðer ayrýþtýrmasý (singular value decomposition)
üzerinden tanýmlanýr. Ama $Q$ simetrik olduðu için onun öz ayrýþtýrmasýný
(eigen decomposition) yazsam da olur herhalde, $Q$'yu su sekilde yazsaydim,

$$
Q = U D U^T
$$

Eðer $Q$ pozitif yarý kesin ise o zaman $D$ içinde bazý deðerlerin sýfýr
olmasý mümkün, yani þunun gibi bir durum olabilir, 

$$
= U \left[\begin{array}{ccccc}
d_1 & & & & \\
& \ddots & & & \\
& & d_r & & \\
& &  & 0 & \\
& &  &  & 0 
\end{array}\right]
U^T
$$

$Q^+$ sözde tersini tanýmlamanýn bir yolu üstteki öz ayrýþtýrma
üzerindendir (dikdörtgensel matrisler için SVD üzerinden). 

Ama ondan önce bir soru, eðer tüm deðerleri sýfýr olmayan bir $D$ üzerinden
bir öz ayrýþtýrmam olsaydý? Basit, $U D^{-1} U^T$ deðil mi? Unutmayalým $U$
matrisi dikgen.

Ama pozitif yarý kesinlik var, o yüzden $D$'nin tersini alamýyorum. Bu
sebeple sözde ters iþlemi $D$ içindeki tersi alýnabilen deðerlerin tersini
alýp diðerlerini olduðu gibi býrakmak üzerinden tanýmlanmýþtýr. 

$$
Q^+ = U \left[\begin{array}{ccccc}
1/d_1 & & & & \\
& \ddots & & & \\
& & 1/d_r & & \\
& &  & 0 & \\
& &  &  & 0 
\end{array}\right]
U^T
$$

Üsttekine bazen ``Moore-Penrose sözde tersi'' ismi verildiðini de
duyabilirsiniz, aslýnda pek çok farklý sözde ters yöntemleri var, ama
standart olan üstteki.











[devam edecek]

Kaynaklar

[1] Tibshirani, {\em Convex Optimization, Lecture Video 11}, 
\url{https://www.youtube.com/channel/UCIvaLZcfz3ikJ1cD-zMpIXg}   

\end{document}
